input {
    file {
        path => "/home/capostol/Documents/logstash-7.1.1/event-data/java_errors.log"
        start_position => "beginning"
        type => "java"

        codec => multiline {
            pattern => "^%{CATALINA_DATESTAMP}"
            negate => true
            what => "previous"
            auto_flush_interval => 5
        }
    }
}

filter {
    mutate {
        replace => { type => "error" }
    }

    grok {
        match => { "message" => "%{TIMESTAMP_ISO8601:[@metadata][timestamp]} *%{LOGLEVEL:level} \[%{DATA:application},%{DATA:traceId},%{DATA:spanId},%{DATA:zipkin}\]" }
    }
}

output {
  elasticsearch {
       hosts => [ "localhost:9200" ]
       index => "%{type}-%{+YYYY.MM.dd}"
       document_type => "default"
       http_compression => true
  }

   stdout {
       codec => rubydebug {
           metadata => true
       }
   }
}